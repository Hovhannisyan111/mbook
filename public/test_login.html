<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>MBOOK - Test Login</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="css/auth.css">
    <style>
        .debug-info {
            background: #f0f0f0;
            padding: 10px;
            margin: 10px 0;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="auth-container">
        <img src="../images/logo.png" alt="MBOOK Logo" class="logo-img">
        <form class="auth-form" id="loginForm" action="#" method="POST">
            <input type="email" name="email" placeholder="Email" required autocomplete="username">
            <input type="password" name="password" placeholder="Password" required autocomplete="current-password">
            <button type="submit" class="login-btn">LOGIN NOW</button>
        </form>
        <div class="auth-links">
            <span class="signup-text">Don't have an account? <a href="register.html">SIGN UP</a></span>
            <a href="#" class="forgot-link">Forgot Password?</a>
        </div>
        
        <div class="debug-info">
            <h4>Debug Info:</h4>
            <div id="debugOutput">Ready to test...</div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const loginForm = document.getElementById('loginForm');
            const debugOutput = document.getElementById('debugOutput');
            
            function log(message) {
                const timestamp = new Date().toLocaleTimeString();
                debugOutput.innerHTML += `<div>[${timestamp}] ${message}</div>`;
                console.log(message);
            }
            
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                const email = loginForm.email.value.trim();
                const password = loginForm.password.value.trim();
                
                log(`Attempting login with email: ${email}`);
                
                if (!email || !password) {
                    log('Error: Empty email or password');
                    alert('Please enter both email and password.');
                    return;
                }

                // Create form data
                const formData = new FormData();
                formData.append('email', email);
                formData.append('password', password);

                log('Sending request to login.php...');

                // Send AJAX request
                fetch('../backend/auth/login.php', {
                    method: 'POST',
                    body: formData
                })
                .then(response => {
                    log(`Response status: ${response.status}`);
                    log(`Response headers: ${JSON.stringify([...response.headers.entries()])}`);
                    return response.text();
                })
                .then(data => {
                    log(`Raw response data: "${data}"`);
                    log(`Response data length: ${data.length}`);
                    log(`Response data trimmed: "${data.trim()}"`);
                    
                    // Trim the response and check for success
                    const trimmedData = data.trim();
                    if (trimmedData === 'success') {
                        log('✅ Login successful, redirecting to home.html...');
                        setTimeout(() => {
                            window.location.href = 'home.html';
                        }, 1000);
                    } else {
                        log(`❌ Login failed with response: "${trimmedData}"`);
                        alert('Login failed: ' + trimmedData);
                    }
                })
                .catch(error => {
                    log(`❌ Network error: ${error.message}`);
                    console.error('Error:', error);
                    alert('Login failed. Please try again.');
                });
            });
        });
    </script>
</body>
</html> 